<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PRASCO Admin Dashboard - Digitales Schwarzes Brett</title>
    <link rel="stylesheet" href="/css/admin.css" />
    <link rel="icon" type="image/x-icon" href="https://www.prasco.net/favicon.ico" />
  </head>
  <body>
    <div class="admin-layout">
      <nav class="sidebar">
        <div class="sidebar-header">
          <img
            src="https://www.prasco.net/content/files/images/Prasco/logo-small.png"
            alt="PRASCO"
            class="logo-image"
            style="max-width: 150px; margin-bottom: 1rem"
          />
          <h2>Admin Panel</h2>
        </div>
        <ul class="sidebar-menu">
          <li>
            <a href="#dashboard" class="active"><span class="icon">â—‰</span> Dashboard</a>
          </li>
          <li>
            <a href="#posts"><span class="icon">â–¤</span> BeitrÃ¤ge</a>
          </li>
          <li>
            <a href="#categories"><span class="icon">â—ˆ</span> Kategorien</a>
          </li>
          <li>
            <a href="#displays"><span class="icon">â–¦</span> Displays</a>
          </li>
          <li>
            <a href="#users"><span class="icon">â—</span> Benutzer</a>
          </li>
          <li>
            <a href="#livedata"><span class="icon">ğŸšŒ</span> Live-Daten</a>
          </li>
          <li>
            <a href="#settings"><span class="icon">âš™</span> Einstellungen</a>
          </li>
          <li>
            <a href="#" id="logout"><span class="icon">â»</span> Logout</a>
          </li>
        </ul>
      </nav>

      <main class="admin-content">
        <header class="admin-header">
          <h1 id="page-title">Dashboard</h1>
          <div class="user-info">
            <button
              class="btn btn-secondary btn-sm"
              id="changePasswordBtn"
              title="Eigenes Passwort Ã¤ndern"
            >
              â–·
            </button>
            <span id="username">Admin</span>
            <span class="user-role-badge" id="userRoleBadge"></span>
          </div>
        </header>

        <div class="content-area">
          <!-- Dashboard Section -->
          <section id="dashboard-section" class="section active">
            <div class="stats-grid">
              <div class="stat-card clickable" data-target="posts-section">
                <h3 data-i18n="dashboard.activePosts">Aktive BeitrÃ¤ge</h3>
                <p class="stat-number" id="active-posts">0</p>
              </div>
              <div class="stat-card clickable" data-target="posts-section">
                <h3 data-i18n="dashboard.scheduledPosts">Geplante BeitrÃ¤ge</h3>
                <p class="stat-number" id="scheduled-posts">0</p>
              </div>
              <div class="stat-card clickable" data-target="categories-section">
                <h3 data-i18n="dashboard.categories">Kategorien</h3>
                <p class="stat-number" id="total-categories">0</p>
              </div>
              <div class="stat-card clickable" data-target="displays-section">
                <h3>Displays</h3>
                <p class="stat-number" id="total-displays">0</p>
              </div>
              <div class="stat-card clickable" data-target="media-section">
                <h3 data-i18n="dashboard.media">Medien</h3>
                <p class="stat-number" id="total-media">0</p>
              </div>
            </div>

            <div class="quick-actions">
              <h2 data-i18n="dashboard.quickActions">Schnellaktionen</h2>
              <button class="btn btn-primary" id="quickNewPostBtn" data-i18n="dashboard.newPost">
                Neuer Beitrag
              </button>
              <button
                class="btn btn-secondary"
                id="openDisplayBtn"
                data-i18n="dashboard.openDisplay"
              >
                Display Ã¶ffnen
              </button>
              <button
                class="btn btn-accent"
                id="openPresentationBtn"
                data-i18n="dashboard.presentationMode"
                title="Manuelle Navigation mit Pfeiltasten oder Mausklick"
              >
                â–· Vortragsmodus
              </button>
            </div>
          </section>

          <!-- Posts Section -->
          <section id="posts-section" class="section">
            <div class="section-header">
              <h2>BeitrÃ¤ge verwalten</h2>
              <div>
                <button class="btn btn-success" id="showPostFormBtn">+ Neuer Beitrag</button>
                <button class="btn btn-danger" id="deleteAllPostsBtn" style="margin-left: 10px;">ğŸ—‘ï¸ Alle lÃ¶schen</button>
              </div>
            </div>

            <div id="post-form" class="form-container" style="display: none">
              <form id="postForm">
                <div class="form-row">
                  <div class="form-group">
                    <label for="post-title" data-translate="form.title">Titel *</label>
                    <input type="text" id="post-title" name="title" required />
                  </div>

                  <div class="form-group">
                    <label for="post-type" data-translate="form.type">Typ *</label>
                    <select id="post-type" name="content_type" required>
                      <option value="text" data-translate="type.text">ğŸ“ Text</option>
                      <option value="image" data-translate="type.image">ğŸ–¼ï¸ Bild</option>
                      <option value="video" data-translate="type.video">ğŸ¥ Video</option>
                      <option value="html" data-translate="type.html">ğŸŒ HTML</option>
                      <option value="presentation" data-translate="type.presentation">ğŸ“Š PowerPoint PrÃ¤sentation</option>
                      <option value="pdf" data-translate="type.pdf">ğŸ“„ PDF Dokument</option>
                      <option value="word" data-translate="type.word">ğŸ“ƒ Word Dokument</option>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label for="post-category" data-translate="form.category">Kategorie</label>
                  <select id="post-category" name="category_id">
                    <option value="" data-translate="form.noCategory">-- Keine Kategorie --</option>
                  </select>
                </div>

                <!-- Display-Auswahl -->
                <div class="form-group">
                  <label style="font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; font-size: 1.05rem;">
                    <span style="font-size: 1.3rem;">ğŸ“º</span>
                    <span>Display-Zuweisung</span>
                  </label>
                  
                  <!-- Modern Radio Button Cards -->
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem;">
                    <label class="display-mode-card" for="display-mode-all" style="display: flex; align-items: center; gap: 0.75rem; padding: 1rem; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; background: white;">
                      <input type="radio" name="display_mode" value="all" id="display-mode-all" checked style="width: 20px; height: 20px; accent-color: #007bff;" />
                      <div>
                        <div style="font-weight: 600; color: #333; margin-bottom: 0.25rem;">ğŸŒ Alle Displays</div>
                        <div style="font-size: 0.85rem; color: #6c757d;">Auf allen Displays anzeigen</div>
                      </div>
                    </label>
                    <label class="display-mode-card" for="display-mode-specific" style="display: flex; align-items: center; gap: 0.75rem; padding: 1rem; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; background: white;">
                      <input type="radio" name="display_mode" value="specific" id="display-mode-specific" style="width: 20px; height: 20px; accent-color: #007bff;" />
                      <div>
                        <div style="font-weight: 600; color: #333; margin-bottom: 0.25rem;">ğŸ¯ Spezifische Displays</div>
                        <div style="font-size: 0.85rem; color: #6c757d;">Nur bestimmte Displays</div>
                      </div>
                    </label>
                  </div>

                  <!-- Display Selection Container -->
                  <div id="display-selection-container" style="display: none; border: 2px solid #e3f2fd; border-radius: 8px; padding: 1.25rem; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                      <span style="font-size: 1.1rem;">âœ“</span>
                      <label style="font-weight: 600; color: #333; margin: 0;">Displays auswÃ¤hlen:</label>
                    </div>
                    <div id="displays-checkboxes" style="max-height: 240px; overflow-y: auto; padding-right: 0.5rem;">
                      <p style="color: #6c757d; text-align: center; padding: 1rem;">Lade Displays...</p>
                    </div>
                  </div>
                </div>

                <style>
                  .display-mode-card:hover {
                    border-color: #007bff !important;
                    background: #f8f9ff !important;
                    box-shadow: 0 2px 8px rgba(0,123,255,0.15) !important;
                  }
                  
                  .display-mode-card:has(input:checked) {
                    border-color: #007bff !important;
                    background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%) !important;
                    box-shadow: 0 4px 12px rgba(0,123,255,0.2) !important;
                  }
                  
                  .display-mode-card input[type="radio"] {
                    cursor: pointer;
                    flex-shrink: 0;
                  }
                  
                  #displays-checkboxes::-webkit-scrollbar {
                    width: 8px;
                  }
                  
                  #displays-checkboxes::-webkit-scrollbar-track {
                    background: #f1f1f1;
                    border-radius: 4px;
                  }
                  
                  #displays-checkboxes::-webkit-scrollbar-thumb {
                    background: #c1c1c1;
                    border-radius: 4px;
                  }
                  
                  #displays-checkboxes::-webkit-scrollbar-thumb:hover {
                    background: #a8a8a8;
                  }
                </style>

                <div class="form-group">
                  <label for="post-content" data-translate="form.content">Inhalt</label>
                  <textarea id="post-content" name="content" rows="5"></textarea>
                </div>

                <div class="form-group" id="upload-section" style="display: none;">
                  <label style="font-weight: 600; margin-bottom: 0.5rem; display: block;" data-translate="form.uploadContent">Inhalte hochladen</label>
                  
                  <!-- Option 1: Word/PDF Import (nur bei Text/HTML) -->
                  <div id="word-pdf-import" style="margin-bottom: 1rem;">
                    <button type="button" class="btn btn-secondary" id="import-document-btn" style="width: 100%; font-size: 0.95rem;" data-translate="form.importDocument">
                      ğŸ“„ Word/PDF importieren
                    </button>
                    <small style="color: #666; display: block; margin-top: 0.5rem; text-align: center;" data-translate="form.importDocumentHint">
                      Importieren Sie .docx oder .pdf Dateien (max. 10MB)
                    </small>
                  </div>

                  <!-- Option 2: Datei hochladen (nur bei anderen Typen) -->
                  <div id="file-upload-section" style="display: none;">
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 0.5rem;">
                      <button type="button" class="btn btn-secondary" id="trigger-file-upload" style="font-size: 0.9rem; display: inline-block;" data-translate="form.uploadFile">
                        ğŸ“ Datei hochladen
                      </button>
                      <small style="color: #666; align-self: center;" data-translate="form.uploadFileHint">
                        Bilder, Videos, Audio, PDFs, Word, PowerPoint (max. 100MB)
                      </small>
                    </div>
                    <input
                      type="file"
                      id="media-file"
                      name="media_file"
                      accept="image/*,video/*,audio/*,.pdf,.doc,.docx,.pptx,.ppt,.odp"
                      style="display: none;"
                    />
                    <div id="upload-progress" style="display: none; margin-top: 0.5rem">
                      <div style="background: #e0e0e0; border-radius: 4px; height: 20px; overflow: hidden;">
                        <div id="upload-progress-bar" style="background: #007bff; height: 100%; width: 0%; transition: width 0.3s"></div>
                      </div>
                      <small id="upload-status" style="color: #007bff" data-translate="form.uploading">Uploading...</small>
                    </div>
                  </div>

                  <!-- Option 3: Medien-URL (nur bei anderen Typen) -->
                  <div id="media-url-section" style="margin-top: 1rem; display: none;">
                    <label for="media-url" style="font-weight: 500; margin-bottom: 0.5rem; display: block;" data-translate="form.mediaUrl">Medien-URL (oder Datei hochladen)</label>
                    <input
                      type="text"
                      id="media-url"
                      name="media_url"
                      data-translate-placeholder="form.mediaUrlPlaceholder"
                      placeholder="https://... oder /uploads/originals/..."
                      style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;"
                    />
                    <small style="color: #666; display: block; margin-top: 0.5rem;" data-translate="form.mediaUrlHint">
                      YouTube/Vimeo URLs werden automatisch als Video eingebettet
                    </small>
                    
                    <!-- Offline-Download Option (nur fÃ¼r externe Videos) -->
                    <div id="offline-download-section" style="margin-top: 1rem; display: none;">
                      <label class="checkbox-label" style="display: flex; align-items: center; gap: 0.5rem;">
                        <input type="checkbox" id="download-video-offline" />
                        <span data-translate="form.offlineDownload">ğŸ“¥ Video offline verfÃ¼gbar machen</span>
                      </label>
                      <small style="color: #666; display: block; margin-top: 0.25rem; margin-left: 1.5rem;" data-translate="form.offlineDownloadHint">
                        LÃ¤dt das Video automatisch herunter fÃ¼r bessere Performance und Offline-Nutzung
                      </small>
                    </div>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label for="display-duration" data-translate="form.displayDuration">Anzeigedauer (Sek.)</label>
                    <input
                      type="number"
                      id="display-duration"
                      name="display_duration"
                      value="60"
                      min="1"
                    />
                  </div>

                  <div class="form-group">
                    <label for="priority" data-translate="form.priority">PrioritÃ¤t (0-100)</label>
                    <input type="number" id="priority" name="priority" value="0" min="0" max="100" />
                  </div>

                  <div class="form-group">
                    <label for="show-title" style="display: block; margin-bottom: 0.5rem;">Titel anzeigen</label>
                    <div class="toggle-switch">
                      <input type="checkbox" name="show_title" id="show-title" class="toggle-input" />
                      <label for="show-title" class="toggle-label">
                        <span class="toggle-slider"></span>
                      </label>
                    </div>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label for="blend-effect" data-translate="form.blendEffect">Ãœbergangseffekt</label>
                    <select id="blend-effect" name="blend_effect">
                      <option value="" data-translate="form.blendEffectNone">Kein Effekt</option>
                      <option value="fade" data-translate="form.blendEffectFade">Fade (Ãœberblenden)</option>
                      <option value="slide-left" data-translate="form.blendEffectSlideLeft">Slide Left (Nach links)</option>
                      <option value="slide-right" data-translate="form.blendEffectSlideRight">Slide Right (Nach rechts)</option>
                      <option value="slide-up" data-translate="form.blendEffectSlideUp">Slide Up (Nach oben)</option>
                      <option value="slide-down" data-translate="form.blendEffectSlideDown">Slide Down (Nach unten)</option>
                      <option value="zoom-in" data-translate="form.blendEffectZoomIn">Zoom In (Hineinzoomen)</option>
                      <option value="zoom-out" data-translate="form.blendEffectZoomOut">Zoom Out (Herauszoomen)</option>
                    </select>
                    <small style="color: #666; display: block; margin-top: 0.25rem" data-translate="form.blendEffectHint">WÃ¤hlen Sie einen Ãœbergangseffekt zum nÃ¤chsten Beitrag</small>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label for="start-date" data-translate="form.startDate">Start-Datum</label>
                    <input type="datetime-local" id="start-date" name="start_date" />
                  </div>

                  <div class="form-group">
                    <label for="end-date" data-translate="form.endDate">End-Datum</label>
                    <input type="datetime-local" id="end-date" name="end_date" />
                  </div>
                </div>

                <!-- Hintergrundmusik (nur fÃ¼r nicht-Video-Inhalte) -->
                <div class="form-group background-music-section" id="background-music-section">
                  <label> <span class="settings-icon">â™ª</span> <span data-translate="form.backgroundMusicSection">Hintergrundmusik (optional)</span> </label>
                  <small style="color: #666; display: block; margin-bottom: 0.5rem" data-translate="form.backgroundMusicHint">
                    Nur fÃ¼r Text, Bild und HTML-Inhalte. Bei Videos wird der Original-Ton verwendet.
                  </small>
                  <div class="form-row">
                    <div class="form-group" style="flex: 2">
                      <label for="background-music-file" data-translate="form.musicFile">Musik-Datei</label>
                      <input
                        type="file"
                        id="background-music-file"
                        name="background_music_file"
                        accept="audio/*,.mp3,.wav,.ogg,.m4a"
                      />
                      <small style="color: #666">UnterstÃ¼tzt: MP3, WAV, OGG, M4A</small>
                    </div>
                    <div class="form-group" style="flex: 1">
                      <label for="background-music-volume" data-translate="form.musicVolume">LautstÃ¤rke</label>
                      <div class="volume-control">
                        <input
                          type="range"
                          id="background-music-volume"
                          name="background_music_volume"
                          min="0"
                          max="100"
                          value="50"
                        />
                        <span id="volume-display">50%</span>
                      </div>
                    </div>
                  </div>
                  <div id="current-music-info" style="display: none; margin-top: 0.5rem">
                    <small style="color: #28a745">
                      <span class="btn-icon">â™ª</span> Aktuelle Musik:
                      <span id="current-music-name"></span>
                      <button
                        type="button"
                        class="btn btn-sm btn-secondary"
                        id="remove-music-btn"
                        style="margin-left: 0.5rem"
                      >
                        âœ• Entfernen
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-secondary"
                        id="preview-music-btn"
                        style="margin-left: 0.25rem"
                      >
                        â–¶ Vorschau
                      </button>
                    </small>
                  </div>
                  <audio id="music-preview" style="display: none"></audio>
                </div>

                <div class="form-group">
                  <label for="is-active" style="display: block; margin-bottom: 0.5rem;">Aktiv</label>
                  <div class="toggle-switch">
                    <input type="checkbox" name="is_active" id="is-active" checked class="toggle-input" />
                    <label for="is-active" class="toggle-label">
                      <span class="toggle-slider"></span>
                    </label>
                  </div>
                </div>

                <div class="form-actions">
                  <button type="submit" class="btn btn-primary" data-translate="btn.savePost">Beitrag speichern</button>
                  <button type="button" class="btn btn-secondary" id="hidePostFormBtn" data-translate="btn.cancel">
                    Abbrechen
                  </button>
                </div>
              </form>
            </div>

            <div class="posts-list" id="posts-list">
              <!-- Wird dynamisch gefÃ¼llt -->
            </div>

          </section>

          <!-- Categories Section -->
          <section id="categories-section" class="section">
            <div class="section-header">
              <h2>Kategorien verwalten</h2>
              <button class="btn btn-primary" id="showCategoryFormBtn" data-translate="btn.newCategory">+ Neue Kategorie</button>
            </div>

            <div id="category-form" class="form-container" style="display: none">
              <h2>+ Neue Kategorie</h2>
              <form id="categoryForm">
                <div class="form-group">
                  <label for="category-name" data-translate="category.name">Name *</label>
                  <input type="text" id="category-name" name="name" required />
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label for="category-color" data-translate="category.color">Farbe</label>
                    <input type="color" id="category-color" name="color" value="#4caf50" />
                  </div>

                  <div class="form-group">
                    <label for="category-icon" data-translate="category.icon">Icon</label>
                    <select id="category-icon" name="icon" class="icon-select">
                      <optgroup label="Geometrische Formen">
                        <option value="â—">â— Kreis (gefÃ¼llt)</option>
                        <option value="â—‹">â—‹ Kreis (leer)</option>
                        <option value="â—‰">â—‰ Kreis mit Punkt</option>
                        <option value="â—">â— Doppelkreis</option>
                        <option value="â– " selected>â–  Quadrat (gefÃ¼llt)</option>
                        <option value="â–¡">â–¡ Quadrat (leer)</option>
                        <option value="â–ª">â–ª Kleines Quadrat</option>
                        <option value="â–«">â–« Kleines Quadrat (leer)</option>
                        <option value="â—†">â—† Raute (gefÃ¼llt)</option>
                        <option value="â—‡">â—‡ Raute (leer)</option>
                        <option value="â—ˆ">â—ˆ Raute mit Punkt</option>
                        <option value="â–²">â–² Dreieck hoch</option>
                        <option value="â–³">â–³ Dreieck hoch (leer)</option>
                        <option value="â–¼">â–¼ Dreieck runter</option>
                        <option value="â–½">â–½ Dreieck runter (leer)</option>
                        <option value="â—€">â—€ Dreieck links</option>
                        <option value="â–¶">â–¶ Dreieck rechts</option>
                        <option value="â¬Ÿ">â¬Ÿ Sechseck</option>
                        <option value="â¬¢">â¬¢ Sechseck (gefÃ¼llt)</option>
                      </optgroup>
                      <optgroup label="Sterne & Symbole">
                        <option value="â˜…">â˜… Stern (gefÃ¼llt)</option>
                        <option value="â˜†">â˜† Stern (leer)</option>
                        <option value="âœ¦">âœ¦ Stern 4-zackig</option>
                        <option value="âœ§">âœ§ Stern 4-zackig (leer)</option>
                        <option value="âœª">âœª Stern im Kreis</option>
                        <option value="âœ«">âœ« Stern offen</option>
                        <option value="âœ¬">âœ¬ Stern gefÃ¼llt</option>
                        <option value="âœ­">âœ­ Stern umrandet</option>
                        <option value="âœ®">âœ® Stern 6-zackig</option>
                        <option value="âœ¯">âœ¯ Stern 6-zackig (leer)</option>
                      </optgroup>
                      <optgroup label="Pfeile & Zeiger">
                        <option value="â–¸">â–¸ Pfeil rechts</option>
                        <option value="â–¹">â–¹ Pfeil rechts (leer)</option>
                        <option value="â–º">â–º Pfeil rechts (groÃŸ)</option>
                        <option value="â–»">â–» Pfeil rechts (groÃŸ, leer)</option>
                        <option value="â†’">â†’ Pfeil rechts (dÃ¼nn)</option>
                        <option value="â‡’">â‡’ Doppelpfeil</option>
                        <option value="â¤">â¤ Pfeilspitze</option>
                        <option value="â”">â” Pfeil breit</option>
                      </optgroup>
                      <optgroup label="HÃ¤kchen & Kreuze">
                        <option value="âœ“">âœ“ HÃ¤kchen</option>
                        <option value="âœ”">âœ” HÃ¤kchen (fett)</option>
                        <option value="âœ•">âœ• Kreuz</option>
                        <option value="âœ–">âœ– Kreuz (fett)</option>
                        <option value="âœ—">âœ— Kreuz (Ballot)</option>
                        <option value="âœ˜">âœ˜ Kreuz (Ballot, fett)</option>
                      </optgroup>
                      <optgroup label="Info & Status">
                        <option value="â„¹">â„¹ Info</option>
                        <option value="âš ">âš  Warnung</option>
                        <option value="âš¡">âš¡ Blitz</option>
                        <option value="âš™">âš™ Zahnrad</option>
                        <option value="âš‘">âš‘ Flagge</option>
                        <option value="âš">âš Flagge (leer)</option>
                        <option value="â™¦">â™¦ Karo</option>
                        <option value="â™ ">â™  Pik</option>
                        <option value="â™£">â™£ Kreuz</option>
                        <option value="â™¥">â™¥ Herz</option>
                      </optgroup>
                      <optgroup label="Weitere Symbole">
                        <option value="â˜€">â˜€ Sonne</option>
                        <option value="â˜">â˜ Wolke</option>
                        <option value="â˜‚">â˜‚ Regenschirm</option>
                        <option value="â˜">â˜ Telefon</option>
                        <option value="â˜">â˜ Checkbox (leer)</option>
                        <option value="â˜‘">â˜‘ Checkbox (angehakt)</option>
                        <option value="â˜’">â˜’ Checkbox (gekreuzt)</option>
                        <option value="â˜›">â˜› Zeigefinger</option>
                        <option value="â˜">â˜ Zeigefinger (leer)</option>
                        <option value="â™ª">â™ª Note</option>
                        <option value="â™«">â™« Noten</option>
                        <option value="âŒ‚">âŒ‚ Haus</option>
                        <option value="âŒ˜">âŒ˜ Command</option>
                        <option value="â±">â± Stoppuhr</option>
                        <option value="â°">â° Wecker</option>
                      </optgroup>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label for="category-description" data-translate="category.description">Beschreibung</label>
                  <textarea
                    id="category-description"
                    name="description"
                    rows="2"
                    data-translate-placeholder="category.descriptionPlaceholder"
                    placeholder="Optionale Beschreibung..."
                  ></textarea>
                </div>

                <div class="form-actions">
                  <button type="submit" class="btn btn-primary" data-translate="btn.saveCategory">Kategorie erstellen</button>
                  <button type="button" class="btn btn-secondary" id="hideCategoryFormBtn" data-translate="btn.cancel">
                    Abbrechen
                  </button>
                </div>
              </form>
            </div>

            <div class="categories-list" id="categories-list">
              <!-- Wird dynamisch gefÃ¼llt -->
            </div>
          </section>

          <!-- Displays Section -->
          <section id="displays-section" class="section">
            <div class="section-header">
              <h2>Display-Verwaltung</h2>
              <button class="btn btn-primary" id="showDisplayFormBtn">+ Neues Display</button>
            </div>

            <div id="display-form" class="form-container" style="display: none">
              <h2>+ Neues Display</h2>
              <form id="displayForm">
                <div class="form-group">
                  <label for="display-name">Display-Name *</label>
                  <input type="text" id="display-name" name="name" required placeholder="z.B. Empfangsbereich" />
                </div>

                <div class="form-group">
                  <label for="display-identifier">Identifier *</label>
                  <input 
                    type="text" 
                    id="display-identifier" 
                    name="identifier" 
                    required 
                    pattern="[a-zA-Z0-9-_]+"
                    placeholder="z.B. empfangsbereich-1" 
                    title="Nur Buchstaben, Zahlen, Bindestriche und Unterstriche"
                  />
                  <small style="color: #6c757d;">Eindeutiger Identifier fÃ¼r die Display-URL (nur a-z, 0-9, -, _)</small>
                </div>

                <div class="form-group">
                  <label for="display-description">Beschreibung</label>
                  <textarea 
                    id="display-description" 
                    name="description" 
                    rows="3"
                    placeholder="Optionale Beschreibung oder Standort des Displays"
                  ></textarea>
                </div>

                <div class="form-group">
                  <label>
                    <input type="checkbox" id="display-isActive" name="isActive" checked />
                    Display ist aktiv
                  </label>
                  <small style="color: #6c757d; display: block; margin-top: 0.25rem;">Inaktive Displays erhalten keine BeitrÃ¤ge</small>
                </div>

                <div class="form-actions">
                  <button type="submit" class="btn btn-primary">Display erstellen</button>
                  <button type="button" class="btn btn-secondary" id="hideDisplayFormBtn">
                    Abbrechen
                  </button>
                </div>
              </form>
            </div>

            <div class="displays-list" id="displays-list">
              <!-- Wird dynamisch gefÃ¼llt -->
            </div>
          </section>

          <!-- Users Section -->
          <section id="users-section" class="section">
            <div class="section-header">
              <h2>Benutzer verwalten</h2>
              <button class="btn btn-primary" id="showUserFormBtn" data-translate="btn.newUser">+ Neuer Benutzer</button>
            </div>

            <div id="user-form" class="form-container" style="display: none">
              <form id="userForm">
                <div class="form-row">
                  <div class="form-group">
                    <label for="user-firstName" data-translate="users.firstName">Vorname *</label>
                    <input type="text" id="user-firstName" name="firstName" required />
                  </div>

                  <div class="form-group">
                    <label for="user-lastName" data-translate="users.lastName">Nachname *</label>
                    <input type="text" id="user-lastName" name="lastName" required />
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label for="user-email" data-translate="users.email">E-Mail *</label>
                    <input type="email" id="user-email" name="email" required />
                  </div>

                  <div class="form-group">
                    <label for="user-role" data-translate="users.role">Rolle *</label>
                    <select id="user-role" name="role" required>
                      <option value="viewer" data-translate="role.viewer">Betrachter</option>
                      <option value="editor" data-translate="role.editor">Editor</option>
                      <option value="admin" data-translate="role.admin">Administrator</option>
                      <option value="display" data-translate="role.display">Display</option>
                    </select>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label for="user-password" data-translate="users.password">Passwort *</label>
                    <input type="password" id="user-password" name="password" minlength="6" />
                    <small class="form-hint"
                      >Min. 6 Zeichen (leer lassen fÃ¼r keine Ã„nderung bei Bearbeitung)</small
                    >
                  </div>

                  <div class="form-group">
                    <label for="user-isActive" data-translate="common.status">Status</label>
                    <select id="user-isActive" name="isActive">
                      <option value="true" data-translate="common.active">Aktiv</option>
                      <option value="false" data-translate="common.inactive">Inaktiv</option>
                    </select>
                  </div>
                </div>

                <div class="form-actions">
                  <button type="submit" class="btn btn-primary" data-translate="btn.saveUser">Benutzer speichern</button>
                  <button type="button" class="btn btn-secondary" id="hideUserFormBtn" data-translate="btn.cancel">
                    Abbrechen
                  </button>
                </div>
              </form>
            </div>

            <div class="users-list" id="users-list">
              <!-- Wird dynamisch gefÃ¼llt -->
            </div>
          </section>

          <!-- Live-Daten Section -->
          <section id="livedata-section" class="section">
            <h2>ğŸšŒ Live-Daten (Ã–PNV & Verkehr)</h2>

            <!-- Transit / Ã–PNV Konfiguration -->
            <div class="settings-card">
              <h3><span class="settings-icon">ğŸš‰</span> Ã–PNV-Abfahrten</h3>
              <p class="settings-description">
                Konfigurieren Sie die Anzeige von Live-Abfahrtszeiten fÃ¼r Busse und Bahnen in Ihrer NÃ¤he.
              </p>
              <div class="settings-form">
                <div class="form-group">
                  <label class="checkbox-label">
                    <input type="checkbox" id="transit-enabled" />
                    <span>Ã–PNV-Abfahrten auf Display anzeigen</span>
                  </label>
                </div>

                <div id="transit-config" style="display: none">
                  <div class="form-group">
                    <label for="transit-station-search">Station suchen</label>
                    <div class="search-input-group">
                      <input type="text" id="transit-station-search" placeholder="z.B. Hamburg Hbf, Berlin Alexanderplatz..." />
                      <button type="button" class="btn btn-secondary btn-sm" id="transit-search-btn">Suchen</button>
                    </div>
                  </div>

                  <div id="transit-search-results" class="search-results-list" style="display: none"></div>

                  <div id="transit-selected-station" class="selected-station-card" style="display: none">
                    <div class="station-info">
                      <span class="station-icon">ğŸ“</span>
                      <div>
                        <strong id="transit-station-name">â€“</strong>
                        <small id="transit-station-id" class="text-muted"></small>
                      </div>
                    </div>
                    <button type="button" class="btn btn-sm btn-danger" id="transit-remove-station">âœ•</button>
                  </div>

                  <div class="form-row">
                    <div class="form-group">
                      <label for="transit-max-departures">Maximale Abfahrten</label>
                      <input type="number" id="transit-max-departures" value="10" min="3" max="30" />
                    </div>
                    <div class="form-group">
                      <label for="transit-duration">Zeitfenster (Minuten)</label>
                      <input type="number" id="transit-duration" value="60" min="10" max="180" />
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="transit-refresh-interval">Aktualisierungsintervall (Sekunden)</label>
                    <input type="number" id="transit-refresh-interval" value="30" min="10" max="300" />
                  </div>

                  <div class="form-group">
                    <label>Verkehrsmittel filtern</label>
                    <div class="transport-filter-grid">
                      <label class="checkbox-label"><input type="checkbox" id="filter-bus" checked /><span>ğŸšŒ Bus</span></label>
                      <label class="checkbox-label"><input type="checkbox" id="filter-suburban" checked /><span>ğŸš† S-Bahn</span></label>
                      <label class="checkbox-label"><input type="checkbox" id="filter-subway" checked /><span>ğŸš‡ U-Bahn</span></label>
                      <label class="checkbox-label"><input type="checkbox" id="filter-tram" checked /><span>ğŸšŠ Tram</span></label>
                      <label class="checkbox-label"><input type="checkbox" id="filter-regional" checked /><span>ğŸš‚ Regionalzug</span></label>
                      <label class="checkbox-label"><input type="checkbox" id="filter-national" checked /><span>ğŸš„ Fernzug</span></label>
                      <label class="checkbox-label"><input type="checkbox" id="filter-ferry" /><span>â›´ FÃ¤hre</span></label>
                    </div>
                  </div>
                </div>

                <button class="btn btn-primary" id="saveTransitSettings">Einstellungen speichern</button>
                <button class="btn btn-secondary" id="previewTransitData" style="margin-left: 0.5rem">Vorschau</button>
              </div>
            </div>

            <!-- Live-Vorschau Ã–PNV -->
            <div id="transit-preview-card" class="settings-card" style="display: none">
              <h3><span class="settings-icon">ğŸ“‹</span> Ã–PNV-Vorschau</h3>
              <div id="transit-preview-content" class="live-preview-container">
                <p class="text-muted">Klicken Sie auf "Vorschau" um Live-Abfahrten zu laden.</p>
              </div>
            </div>

            <!-- Verkehr / Autobahn Konfiguration -->
            <div class="settings-card">
              <h3><span class="settings-icon">ğŸ›£ï¸</span> Autobahn-Verkehrslage</h3>
              <p class="settings-description">
                Zeigen Sie Staumeldungen, Baustellen und Verkehrswarnungen fÃ¼r ausgewÃ¤hlte Autobahnen an.
              </p>
              <div class="settings-form">
                <div class="form-group">
                  <label class="checkbox-label">
                    <input type="checkbox" id="traffic-enabled" />
                    <span>Verkehrslage auf Display anzeigen</span>
                  </label>
                </div>

                <div id="traffic-config" style="display: none">
                  <div class="form-group">
                    <label for="traffic-highway-select">Autobahnen auswÃ¤hlen</label>
                    <div class="highway-select-wrapper">
                      <select id="traffic-highway-select" multiple size="6">
                        <option value="loading" disabled>Lade Autobahnen...</option>
                      </select>
                      <small>Halten Sie Strg/Cmd gedrÃ¼ckt fÃ¼r Mehrfachauswahl</small>
                    </div>
                  </div>

                  <div id="traffic-selected-highways" class="selected-highways-list"></div>

                  <div class="form-row">
                    <div class="form-group">
                      <label for="traffic-refresh-interval">Aktualisierung (Minuten)</label>
                      <input type="number" id="traffic-refresh-interval" value="5" min="1" max="60" />
                    </div>
                    <div class="form-group">
                      <label for="traffic-max-warnings">Max. Meldungen pro Autobahn</label>
                      <input type="number" id="traffic-max-warnings" value="5" min="1" max="20" />
                    </div>
                  </div>

                  <div class="form-group">
                    <label>Meldungstypen anzeigen</label>
                    <div class="transport-filter-grid">
                      <label class="checkbox-label"><input type="checkbox" id="show-warnings" checked /><span>âš ï¸ Verkehrswarnungen</span></label>
                      <label class="checkbox-label"><input type="checkbox" id="show-roadworks" checked /><span>ğŸš§ Baustellen</span></label>
                      <label class="checkbox-label"><input type="checkbox" id="show-closures" checked /><span>ğŸš« Sperrungen</span></label>
                    </div>
                  </div>
                </div>

                <button class="btn btn-primary" id="saveTrafficSettings">Einstellungen speichern</button>
                <button class="btn btn-secondary" id="previewTrafficData" style="margin-left: 0.5rem">Vorschau</button>
              </div>
            </div>

            <!-- Live-Vorschau Verkehr -->
            <div id="traffic-preview-card" class="settings-card" style="display: none">
              <h3><span class="settings-icon">ğŸ“‹</span> Verkehrs-Vorschau</h3>
              <div id="traffic-preview-content" class="live-preview-container">
                <p class="text-muted">Klicken Sie auf "Vorschau" um Verkehrsdaten zu laden.</p>
              </div>
            </div>

            <!-- Cache Management -->
            <div class="settings-card">
              <h3><span class="settings-icon">ğŸ—‘ï¸</span> Cache-Verwaltung</h3>
              <p class="settings-description">
                Leeren Sie den Cache fÃ¼r Ã–PNV- und Verkehrsdaten, um aktuelle Daten zu erzwingen.
              </p>
              <div class="settings-form">
                <div class="cache-stats" id="cache-stats">
                  <div class="cache-stat-item">
                    <span class="cache-label">Ã–PNV-Cache:</span>
                    <span id="transit-cache-count" class="cache-value">â€“</span>
                  </div>
                  <div class="cache-stat-item">
                    <span class="cache-label">Verkehr-Cache:</span>
                    <span id="traffic-cache-count" class="cache-value">â€“</span>
                  </div>
                </div>
                <button class="btn btn-secondary" id="clearTransitCache">Ã–PNV-Cache leeren</button>
                <button class="btn btn-secondary" id="clearTrafficCache" style="margin-left: 0.5rem">Verkehr-Cache leeren</button>
              </div>
            </div>
          </section>

          <!-- Settings Section -->
          <section id="settings-section" class="section">
            <h2>Einstellungen</h2>

            <!-- System-Modus (Raspberry Pi) -->
            <div class="settings-card" id="system-mode-card" style="display: block;">
              <h3><span class="settings-icon">ğŸ“¡</span> System-Modus</h3>
              <p class="settings-description">
                Wechseln Sie zwischen Normal-Modus (Netzwerk-Verbindung) und Hotspot-Modus (Offline-Betrieb).
              </p>
              
              <div id="system-mode-status" class="system-mode-status">
                <div class="mode-indicator">
                  <span class="mode-icon">â³</span>
                  <span class="mode-text">Status wird geladen...</span>
                </div>
              </div>

              <div class="settings-form">
                <div class="mode-selection">
                  <label class="mode-option">
                    <input type="radio" name="system-mode" value="normal" id="mode-normal">
                    <div class="mode-card">
                      <div class="mode-header">
                        <span class="mode-icon">ğŸŒ</span>
                        <h4>Normal-Modus</h4>
                      </div>
                      <ul class="mode-features">
                        <li>Verbindung zum vorhandenen Netzwerk</li>
                        <li>Internet-Zugang erforderlich</li>
                        <li>Externe Server-URL verwendbar</li>
                      </ul>
                    </div>
                  </label>

                  <label class="mode-option">
                    <input type="radio" name="system-mode" value="hotspot" id="mode-hotspot">
                    <div class="mode-card">
                      <div class="mode-header">
                        <span class="mode-icon">ğŸ“¶</span>
                        <h4>Hotspot-Modus</h4>
                      </div>
                      <ul class="mode-features">
                        <li>Raspberry Pi erstellt WiFi Hotspot</li>
                        <li>SSID: <strong>PRASCO-Display</strong></li>
                        <li>Passwort: <strong>prasco123</strong></li>
                        <li>IP: <strong>192.168.4.1:3000</strong></li>
                      </ul>
                    </div>
                  </label>
                </div>

                <button class="btn btn-primary" id="switchSystemMode" style="margin-top: 1rem;">
                  Modus wechseln
                </button>
              </div>
            </div>

            <!-- Display-Einstellungen -->
            <div class="settings-card">
              <h3><span class="settings-icon">&#9881;</span> Display-Einstellungen</h3>
              <div class="settings-form">
                <div class="form-group">
                  <label for="refresh-interval">Auto-Refresh Intervall (Minuten)</label>
                  <input type="number" id="refresh-interval" value="5" min="1" />
                </div>

                <div class="form-group">
                  <label for="default-duration">Standard Anzeigedauer (Sekunden)</label>
                  <input type="number" id="default-duration" value="10" min="1" />
                </div>

                <div class="form-group">
                  <label class="checkbox-label">
                    <input type="checkbox" id="blend-effects-enabled" />
                    <span>Ãœbergangseffekte aktivieren</span>
                  </label>
                  <small style="color: #666; display: block; margin-top: 0.25rem">
                    Aktiviert animierte ÃœbergÃ¤nge zwischen BeitrÃ¤gen (Fade, Slide, Zoom)
                  </small>
                </div>

                <div class="form-group">
                  <label class="checkbox-label">
                    <input type="checkbox" id="transitions-external-only" />
                    <span>Ãœbergangseffekte nur auf externen Displays</span>
                  </label>
                  <small style="color: #666; display: block; margin-top: 0.25rem">
                    Spart Ressourcen: Raspberry Pi zeigt Posts ohne Animationen, externe Bildschirme mit Effekten
                  </small>
                </div>

                <button class="btn btn-primary" id="saveDisplaySettings">
                  Einstellungen speichern
                </button>
              </div>
            </div>

            <!-- Globale Hintergrundmusik -->
            <div class="settings-card">
              <h3><span class="settings-icon">&#9835;</span> Globale Hintergrundmusik</h3>
              <p class="settings-description">
                Musik die Ã¼ber alle BeitrÃ¤ge hinweg abgespielt wird. Videos werden automatisch stumm
                geschaltet.
              </p>
              <div class="settings-form">
                <div class="form-group">
                  <label class="checkbox-label">
                    <input type="checkbox" id="global-music-enabled" />
                    <span>Globale Hintergrundmusik aktivieren</span>
                  </label>
                </div>

                <div id="global-music-config" style="display: none">
                  <div class="form-group">
                    <label for="global-music-url">Musik-URL</label>
                    <input
                      type="url"
                      id="global-music-url"
                      placeholder="https://example.com/music.mp3"
                    />
                  </div>

                  <div class="form-group">
                    <label for="global-music-file">Oder Musik-Datei hochladen</label>
                    <input type="file" id="global-music-file" accept="audio/*" />
                  </div>

                  <div class="form-group">
                    <label for="global-music-volume"
                      >LautstÃ¤rke: <span id="global-volume-value">30</span>%</label
                    >
                    <input type="range" id="global-music-volume" min="0" max="100" value="30" />
                  </div>

                  <div class="form-group">
                    <label class="checkbox-label">
                      <input type="checkbox" id="global-music-mute-videos" checked />
                      <span>Videos automatisch stumm schalten</span>
                    </label>
                  </div>

                  <div class="form-group">
                    <label for="global-music-priority">Musik-PrioritÃ¤t</label>
                    <select id="global-music-priority">
                      <option value="global">Globale Musik hat Vorrang</option>
                      <option value="post">Post-spezifische Musik hat Vorrang</option>
                    </select>
                    <small>Bestimmt, welche Musik abgespielt wird, wenn sowohl globale als auch post-spezifische Musik konfiguriert sind.</small>
                  </div>
                </div>

                <button class="btn btn-primary" id="saveGlobalMusicSettings">
                  Musik-Einstellungen speichern
                </button>
                <button class="btn btn-secondary" id="testGlobalMusic" style="margin-left: 0.5rem">
                  Test â–·
                </button>
              </div>
            </div>

            <!-- Spracheinstellungen -->
            <div class="settings-card">
              <h3><span class="settings-icon">&#127760;</span> Spracheinstellungen</h3>
              <div class="settings-form">
                <div class="form-group">
                  <label for="app-language">Sprache / Language / Lingua</label>
                  <select id="app-language">
                    <option value="de" data-flag="ğŸ‡©ğŸ‡ª">ğŸ‡©ğŸ‡ª Deutsch</option>
                    <option value="en" data-flag="ğŸ‡¬ğŸ‡§">ğŸ‡¬ğŸ‡§ English</option>
                    <option value="it" data-flag="ğŸ‡®ğŸ‡¹">ğŸ‡®ğŸ‡¹ Italiano</option>
                  </select>
                  <small id="language-hint"
                    >Die Sprache wird fÃ¼r die gesamte BenutzeroberflÃ¤che verwendet.</small
                  >
                </div>
              </div>
            </div>

            <!-- SSO Einstellungen (nur fÃ¼r Super-Admin) -->
            <div id="sso-settings-section" class="settings-card" style="display: none">
              <h3>
                <span class="settings-icon">&#128274;</span> Single Sign-On (SSO) Konfiguration
              </h3>
              <p class="settings-description">
                Konfigurieren Sie Azure AD / Microsoft Entra ID fÃ¼r SSO-Authentifizierung.
                <a
                  href="/SSO-SETUP.md"
                  target="_blank"
                  title="Setup-Anleitung Ã¶ffnen"
                  class="help-link"
                  >Setup-Anleitung</a
                >
              </p>

              <div id="sso-status-banner" class="sso-status-banner">
                <span class="sso-status-indicator"></span>
                <span class="sso-status-text">Status wird geladen...</span>
              </div>

              <form id="sso-config-form" class="settings-form">
                <!-- SSO aktivieren -->
                <div class="form-group">
                  <label class="checkbox-label sso-toggle">
                    <input type="checkbox" id="sso-enabled" name="enabled" />
                    <span>SSO aktivieren</span>
                  </label>
                </div>

                <div id="sso-config-details" class="sso-config-details" style="display: none">
                  <!-- Provider -->
                  <div class="form-group">
                    <label for="sso-provider">SSO Provider</label>
                    <select id="sso-provider" name="provider">
                      <option value="azure_ad">Azure AD / Microsoft Entra ID</option>
                      <option value="ldap">
                        LDAP / Active Directory (Windows Server 2016/2019/2022)
                      </option>
                      <option value="adfs" disabled>
                        Active Directory Federation Services (geplant)
                      </option>
                    </select>
                  </div>

                  <!-- Azure AD Konfiguration -->
                  <div id="azure-ad-config" class="sso-provider-config">
                    <h4>Azure AD Konfiguration</h4>

                    <div class="form-row">
                      <div class="form-group">
                        <label for="azure-tenant-id">Tenant ID *</label>
                        <input
                          type="text"
                          id="azure-tenant-id"
                          name="tenantId"
                          placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
                        />
                        <small>Directory (tenant) ID aus Azure Portal</small>
                      </div>

                      <div class="form-group">
                        <label for="azure-client-id">Client ID (Application ID) *</label>
                        <input
                          type="text"
                          id="azure-client-id"
                          name="clientId"
                          placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
                        />
                        <small>Application (client) ID aus Azure Portal</small>
                      </div>
                    </div>

                    <div class="form-group">
                      <label for="azure-client-secret">Client Secret *</label>
                      <input
                        type="password"
                        id="azure-client-secret"
                        name="clientSecret"
                        placeholder="Geheimnis eingeben..."
                      />
                      <small>Client Secret aus Azure Portal (Zertifikate & Geheimnisse)</small>
                    </div>

                    <div class="form-row">
                      <div class="form-group">
                        <label for="azure-redirect-uri">Redirect URI</label>
                        <input
                          type="text"
                          id="azure-redirect-uri"
                          name="redirectUri"
                          placeholder="http://localhost:3000/api/auth/sso/callback"
                        />
                        <small>Muss mit Azure AD App Registration Ã¼bereinstimmen</small>
                      </div>

                      <div class="form-group">
                        <label for="azure-logout-uri">Post-Logout URI</label>
                        <input
                          type="text"
                          id="azure-logout-uri"
                          name="postLogoutRedirectUri"
                          placeholder="http://localhost:3000/admin"
                        />
                      </div>
                    </div>
                  </div>

                  <!-- LDAP / Active Directory Konfiguration -->
                  <div id="ldap-config" class="sso-provider-config" style="display: none">
                    <h4><span class="subsection-icon">â¬¡</span> LDAP / Active Directory</h4>
                    <p class="form-help">FÃ¼r Windows Server 2016/2019/2022 mit Active Directory</p>

                    <div class="form-row">
                      <div class="form-group">
                        <label for="ldap-url">LDAP Server URL *</label>
                        <input
                          type="text"
                          id="ldap-url"
                          name="ldapUrl"
                          placeholder="ldap://dc.firma.local:389"
                        />
                        <small>FÃ¼r SSL: ldaps://dc.firma.local:636</small>
                      </div>

                      <div class="form-group">
                        <label for="ldap-base-dn">Base DN *</label>
                        <input
                          type="text"
                          id="ldap-base-dn"
                          name="ldapBaseDN"
                          placeholder="DC=firma,DC=local"
                        />
                        <small>Root-DN Ihrer Active Directory Domain</small>
                      </div>
                    </div>

                    <div class="form-row">
                      <div class="form-group">
                        <label for="ldap-bind-dn">Bind DN (Service-Account) *</label>
                        <input
                          type="text"
                          id="ldap-bind-dn"
                          name="ldapBindDN"
                          placeholder="CN=svc_prasco,CN=Users,DC=firma,DC=local"
                        />
                        <small>Distinguished Name des Service-Accounts</small>
                      </div>

                      <div class="form-group">
                        <label for="ldap-bind-password">Bind Passwort *</label>
                        <input
                          type="password"
                          id="ldap-bind-password"
                          name="ldapBindPassword"
                          placeholder="Service-Account Passwort"
                        />
                      </div>
                    </div>

                    <div class="form-group">
                      <label for="ldap-user-search-base">Benutzer-Suchbasis *</label>
                      <input
                        type="text"
                        id="ldap-user-search-base"
                        name="ldapUserSearchBase"
                        placeholder="CN=Users,DC=firma,DC=local"
                      />
                      <small>OU/CN in der nach Benutzern gesucht wird</small>
                    </div>

                    <div class="form-group">
                      <label for="ldap-user-search-filter">Benutzer-Suchfilter</label>
                      <input
                        type="text"
                        id="ldap-user-search-filter"
                        name="ldapUserSearchFilter"
                        placeholder="(sAMAccountName={{username}})"
                      />
                      <small>{{username}} wird durch den eingegebenen Benutzernamen ersetzt</small>
                    </div>

                    <h5>Gruppen-basierte Rollenzuweisung (optional)</h5>

                    <div class="form-row">
                      <div class="form-group">
                        <label for="ldap-admin-group">Admin-Gruppe</label>
                        <input
                          type="text"
                          id="ldap-admin-group"
                          name="ldapAdminGroup"
                          placeholder="CN=PRASCO-Admins,OU=Groups,DC=firma,DC=local"
                        />
                        <small>Mitglieder erhalten Admin-Rolle</small>
                      </div>

                      <div class="form-group">
                        <label for="ldap-editor-group">Editor-Gruppe</label>
                        <input
                          type="text"
                          id="ldap-editor-group"
                          name="ldapEditorGroup"
                          placeholder="CN=PRASCO-Editors,OU=Groups,DC=firma,DC=local"
                        />
                        <small>Mitglieder erhalten Editor-Rolle</small>
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="checkbox-label">
                        <input type="checkbox" id="ldap-tls-reject" name="ldapTlsReject" />
                        <span
                          >Selbstsignierte Zertifikate ablehnen (fÃ¼r Produktionsumgebungen
                          empfohlen)</span
                        >
                      </label>
                    </div>
                  </div>

                  <hr class="settings-divider" />

                  <!-- Benutzereinstellungen -->
                  <h4>Benutzer-Einstellungen</h4>

                  <div class="form-group">
                    <label class="checkbox-label">
                      <input type="checkbox" id="sso-auto-create" name="autoCreateUsers" checked />
                      <span>Benutzer automatisch erstellen bei erstem SSO-Login</span>
                    </label>
                  </div>

                  <div class="form-row">
                    <div class="form-group">
                      <label for="sso-default-role">Standard-Rolle fÃ¼r neue SSO-Benutzer</label>
                      <select id="sso-default-role" name="defaultRole">
                        <option value="viewer">Betrachter</option>
                        <option value="editor" selected>Editor</option>
                        <option value="admin">Administrator</option>
                      </select>
                    </div>

                    <div class="form-group">
                      <label for="sso-allowed-domains">Erlaubte E-Mail-Domains</label>
                      <input
                        type="text"
                        id="sso-allowed-domains"
                        name="allowedDomains"
                        placeholder="z.B. firma.de, firma.com"
                      />
                      <small>Leer = alle Domains erlaubt, Komma-getrennt fÃ¼r mehrere</small>
                    </div>
                  </div>
                </div>

                <!-- Aktionen -->
                <div class="form-actions sso-actions">
                  <button type="submit" class="btn btn-primary" id="sso-save-btn">
                    <span class="btn-icon">&#10003;</span> Konfiguration speichern
                  </button>
                  <button type="button" class="btn btn-secondary" id="sso-test-btn">
                    <span class="btn-icon">&#8635;</span> Verbindung testen
                  </button>
                </div>

                <div id="sso-test-result" class="sso-test-result" style="display: none"></div>
              </form>
            </div>

            <!-- Info / Ãœber diese Anwendung -->
            <div class="settings-card">
              <h3><span class="settings-icon">&#9432;</span> Ãœber diese Anwendung</h3>
              <div class="app-info-section">
                <div class="app-info-logo">
                  <div class="app-logo-circle">
                    <span>P</span>
                  </div>
                </div>
                <div class="app-info-details">
                  <h4>PRASCO Digital Signage</h4>
                  <p class="app-description">
                    Digitales Schwarzes Brett fÃ¼r Unternehmen und Organisationen
                  </p>

                  <div class="app-info-grid">
                    <div class="app-info-item">
                      <span class="info-label">Version</span>
                      <span class="info-value" id="app-version">1.0.0</span>
                    </div>
                    <div class="app-info-item">
                      <span class="info-label">Entwickler</span>
                      <span class="info-value">Christian PÃ¶ser</span>
                    </div>
                    <div class="app-info-item">
                      <span class="info-label">Lizenz</span>
                      <span class="info-value">MIT License</span>
                    </div>
                    <div class="app-info-item">
                      <span class="info-label">Build</span>
                      <span class="info-value" id="app-build-date">2025</span>
                    </div>
                  </div>

                  <div class="app-tech-stack">
                    <span class="tech-badge">Node.js</span>
                    <span class="tech-badge">Express</span>
                    <span class="tech-badge">TypeScript</span>
                    <span class="tech-badge">PostgreSQL</span>
                    <span class="tech-badge">Sequelize</span>
                  </div>

                  <div class="app-links">
                    <a href="https://github.com" target="_blank" class="app-link"> â†’ Repository </a>
                    <a href="/api/docs" target="_blank" class="app-link"> â†’ API Dokumentation </a>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>

        <footer class="admin-footer">
          <div class="footer-left">
            <span>Â© 2025 PRASCO - Digitales Schwarzes Brett</span>
          </div>
          <div class="footer-right">
            <span id="footer-clock" class="footer-clock">--:--:--</span>
            <span id="footer-date" class="footer-date"></span>
          </div>
        </footer>
      </main>
    </div>

    <!-- Modal: Eigenes Passwort Ã¤ndern -->
    <div id="password-modal" class="modal" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h3>â–· Passwort Ã¤ndern</h3>
          <button class="modal-close" id="closePasswordModal">&times;</button>
        </div>
        <form id="changePasswordForm">
          <div class="form-group">
            <label for="current-password">Aktuelles Passwort *</label>
            <input type="password" id="current-password" name="currentPassword" required />
          </div>
          <div class="form-group">
            <label for="new-password">Neues Passwort *</label>
            <input type="password" id="new-password" name="newPassword" minlength="6" required />
            <small class="form-hint">Mindestens 6 Zeichen</small>
          </div>
          <div class="form-group">
            <label for="confirm-password">Passwort bestÃ¤tigen *</label>
            <input
              type="password"
              id="confirm-password"
              name="confirmPassword"
              minlength="6"
              required
            />
          </div>
          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Passwort Ã¤ndern</button>
            <button type="button" class="btn btn-secondary" id="cancelPasswordChange">
              Abbrechen
            </button>
          </div>
        </form>
      </div>
    </div>

    <script src="/js/admin.js?v=2.1"></script>
  </body>
</html>
